package br.com.fiap.htf.DAO;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class DAO {

	//atributo responsavel por ter a conexao
	private Connection conn;
	//responsavel por indicar o drive de conexao 
	public DAO () {
	    try {
	    Class.forName("oracle.jdbc.driver.OracleDriver");
	    }catch (ClassNotFoundException e) {
	        e.printStackTrace();
	    }
	}

	//disponibiliza a conexao aberta para outras classes
    public Connection getConnection() {
        openConnection();
        return this.conn;
    }
    //abre a conexao com o oracle atraves do drive mencionado
    private void openConnection() {
        try {
            if (this.conn == null) {
            	this.conn = DriverManager.getConnection("jdbc:oracle:thin:@oracle.fiap.com.br:1521:ORCL", "RM92721", "180778");
            }
            System.out.println("A conexão está aberta!");
        }catch (SQLException e) {
            e.printStackTrace();
    }
    }
    //funcao de fechamento da conexao
    private void closeConnection() {
        try {
        if (this.conn != null) {
            this.conn.close();
            }
        }catch(SQLException e) {
            e.printStackTrace();
        }
    }


    //Responsavel por executar (Insert, delete, update) e mostar linhas afetadas
        public int executeCommand(PreparedStatement stmt) {
            int j = 0;
            try {
                j = stmt.executeUpdate();
            }catch (SQLException e) {
                e.printStackTrace();
            }finally {
                closeConnection();
            }
            return j;
        }
        //Responsavel pela busca de dados na base (Select)
        public ResultSet getData(PreparedStatement stmt) {
            ResultSet rs = null;
            try {
                rs = stmt.executeQuery();
            }catch (SQLException e) {
                e.printStackTrace();
            }
            return rs;
        }




}